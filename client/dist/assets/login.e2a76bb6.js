import{u as b,h as t,q as y,o as i,c,s as U,t as m,i as _,a as e,j as f,v as g,g as N,e as h,k as V,x as C}from"./index.49611be7.js";const M={class:"login"},B=e("div",{class:"header"},"Login",-1),I=["onSubmit"],L={class:"form-group"},P={for:"username"},T=h("User Name "),D={key:0,class:"msg red"},j={class:"form-group"},q={for:"password"},z=h("Password "),E={key:0,class:"msg red"},R=e("div",{class:"btn-group"},[e("div",{class:"right"},[e("input",{type:"submit",value:"Login",class:"btn"})])],-1),G={__name:"login",setup(A){const d=b(),o=t(""),n=t(""),u=t(""),l=t(""),p=t(""),v=t(!1),w=y();function k(){o.value!=""&&(u.value="")}function S(){n.value!=""&&(l.value="")}function x(){if(o.value=="")return u.value="Set Username",!1;if(n.value=="")return l.value="Set Password",!1;V.post("/api/v2/user/login",{username:o.value,password:n.value}).then(s=>{v.value=!0,s.data.success&&(window.localStorage.setItem("user-token",s.data.token),w.push("/"),C.user.userSuccess((a,r)=>{a||(d.setLogin(!0),d.setToken(s.data.token),d.setUser(r.user.data))}))}).catch(s=>{s.response.data.error&&(p.value=s.response.data.error,v.value=!1),console.log(s.response)})}return(s,a)=>(i(),c("div",M,[B,p.value!==""?(i(),c("div",{key:0,class:U(v.value?"message":"message red")},m(p.value),3)):_("",!0),e("form",{onSubmit:N(x,["prevent"]),class:"c-form"},[e("div",L,[e("label",P,[T,u.value!=""?(i(),c("span",D,m(u.value),1)):_("",!0)]),f(e("input",{type:"text",class:"form-text",onInput:k,"onUpdate:modelValue":a[0]||(a[0]=r=>o.value=r),placeholder:"User Name",id:"username"},null,544),[[g,o.value]])]),e("div",j,[e("label",q,[z,l.value!=""?(i(),c("span",E,m(l.value),1)):_("",!0)]),f(e("input",{type:"password",onInput:S,"onUpdate:modelValue":a[1]||(a[1]=r=>n.value=r),class:"form-text",placeholder:"Password",id:"password"},null,544),[[g,n.value]])]),R],40,I)]))}};export{G as default};
